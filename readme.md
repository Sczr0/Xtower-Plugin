# Xtower-Plugin

Xtower-Plugin 是一个原有的 JS 功能集成 Plugin，包括了随机歌词，聪明Bingo，谁是卧底（测试），狼人杀（测试）功能，后续可能会继续添加。

## 安装

在 Yunzai 目录下运行：

> 使用Github

```
#安装插件本体
git clone --depth=1 https://github.com/Sczr0/Xtower-Plugin.git ./plugins/Xtower-Plugin/ 
#进入插件目录
cd ./plugins/Xtower-Plugin/ 
#安装插件所需依赖
pnpm install -P
```
> 使用Gitee

```
#安装插件本体
git clone --depth=1 https://gitee.com/sczr/Xtower-Plugin.git ./plugins/Xtower-Plugin/ 
#进入插件目录
cd ./plugins/Xtower-Plugin/ 
#安装插件所需依赖
pnpm install -P
```
> [!TIP]
> 如果安装依赖时速度过慢，运行：
> 
>```
> pnpm config set registry https://registry.npmmirror.com
>```

## 功能

### 随机歌词

在使用这个功能之前，你需要**至少有一个 git 歌词存储库，并更新公用库**，否则该功能不会正常工作。

歌词需要以 txt 格式存储，并建议去除歌手信息（除非你想抽歌词的时候抽出来这东西）（划掉）

如果一个歌词 txt 没有空行，使用抽歌词并选中该 txt 时，会随机发送一行

如果有，则会按照空行进行分段，并随机发送一段

具体分段的歌词可以参考：[yllyrics](https://github.com/Sczr0/yllyrics)

#### **以下为用户功能**

| **功能名称**               | **功能说明**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| 抽歌词 [-riv]              | 随机抽取一条歌词（添加 `-riv` 去除输出中的歌曲信息）                        |
| 抽歌词 <数量> [-riv]       | 批量抽取指定数量的歌词（添加 `-riv` 去除输出中的歌曲信息）                  |

#### **以下为管理功能**

| **功能名称**               | **功能说明**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| #获取歌词 <库名> <仓库名>   | 从指定的Git仓库获取歌词，并将其添加到指定的歌词库中（会覆盖掉原有的歌词，如果有的话）                                  |
| #新建歌词仓库 <名称> <Git URL>  | 添加新的歌词Git仓库                                                            |
| #删除歌词仓库 <名称>        | 删除指定的歌词Git仓库                                                            |
| #新建歌词库 <名称>          | 创建新的歌词库                                                              |
| #删除歌词库 <名称>          | 删除指定的歌词库                                                              |
| #关联群组 <群号> <歌词库名> | 将群组与歌词库关联，该群组将只会抽取到该歌词库的歌词（删除歌词库时自动解除所有关联）                                                                                                 |
| #歌词库列表                 | 列出所有歌词库                                                              |
| #仓库列表                   | 列出所有歌词Git仓库                                                            |
| #设置频率限制 <次数> <冷却秒数> | 设置抽歌词频率限制                                                      |
| #更新公用库 <仓库名>        | 更新公用歌词库，该库为你默认想让用户抽取的歌词库。如果公用歌词库无歌词，则私聊抽歌词时会报错，未关联其他歌词库的群组抽取时也会报错 |

PS：如果不想这么麻烦地配置，复制以下指令可以进行默认配置~

#新建歌词仓库 bingo https://gitcode.com/Sczr0/bingolyrics.git

#更新公用库 bingo

### 聪明 Bingo

这是一个 bingo 游戏实现，原游戏为聪明 Bingo，游戏需要找到一个可以做到五连勾且同时满足所有格子要求的解。

#### 可用指令

| **指令格式**           | **功能描述**                                                                 |
|------------------------|-----------------------------------------------------------------------------|
| #今日bingo             | 获取今日题目                                                                |
| #bingo xx xx xx ...    | 提交题目答案，其中 `xx` 的第1个数代表行，第2个数代表列，比如 `13` 代表第一行第三列。提交答案时，需要将答案打勾的全部格子提交，否则会验证失败 |
| #查询Bingo排名         | 查询自己的提交排名和今日提交时间排名前三       |

### 谁是卧底（测试）

这是一个谁是卧底の游戏实现，玩家分为平民和卧底两种身份，通过发言和投票找出卧底或隐藏身份。

#### 游戏规则

- 游戏需要至少3人才能开始。
- 平民会获得相同的词语，卧底会获得一个相似的词语。
- 玩家轮流发言描述自己的词语（不能直接说出词语）。
- 发言结束后投票选出最可疑的玩家。

- **游戏目标**：
  - 平民：找出并淘汰卧底。
  - 卧底：隐藏身份活到最后。

#### 可用指令

| **指令格式**         | **功能描述**                                                                 |
|----------------------|-----------------------------------------------------------------------------|
| #卧底创建 [明牌/暗牌] | 创建游戏房间，可选明牌(发牌时公开身份)或暗牌(发牌时隐藏身份)模式，默认为暗牌。             |
| #加入卧底            | 加入已创建的游戏。                                                          |
| #退出卧底            | 退出等待中的游戏（房主退出将解散游戏）。                                     |
| #开始卧底            | 房主可开始游戏（需至少3人）。                                               |
| #结束发言 / #发言结束 | 当前发言玩家结束自己的发言回合。                                             |
| #投票 [编号]          | 投票淘汰指定编号的玩家（如 `#投票 01`）。                                    |
| #结束卧底            | 房主可强制结束进行中的游戏。                                                |

### 狼人杀（测试）

这是一个狼人杀游戏插件的实现。玩家将被分为狼人、村民和神民阵营，通过夜晚行动、白天发言和投票来淘汰对立阵营。

#### 游戏规则

- 游戏需要至少6名玩家才能开始。
- 玩家会被分配不同角色：狼人、村民、预言家、女巫、猎人、守卫。
- 游戏分为夜晚和白天两个阶段交替进行：
  - **夜晚**：
    - 狼人选择击杀目标。
    - 预言家查验玩家身份（好人/狼人）。
    - 守卫选择守护一名玩家（不能连续两晚守护同一个人）。
    - 女巫在得知夜晚袭击情况后，可以选择使用解药（救人）或毒药（杀人），药剂各只能使用一次。
  - **白天**：
    - 公布昨晚死讯（可能有平安夜）。
    - 若猎人死亡，可以选择开枪带走一名玩家。
    - 存活玩家按随机顺序轮流发言（45秒/人）。
    - 发言结束后，所有存活玩家投票选出一人放逐。

- **游戏目标**：
  - **狼人阵营**：狼人数量大于等于存活的好人数量（屠城）
    - 这里的好人数量包括所有存活的神民和村民的总和
  - **好人阵营（村民+神民）**：淘汰所有狼人。

#### 可用指令

| **指令格式**             | **功能描述**                                                                 |
|--------------------------|-----------------------------------------------------------------------------|
| #创建狼人杀              | 在当前群聊创建一局新的狼人杀游戏，发送者成为房主。                           |
| #加入狼人杀              | 加入当前群聊等待中的狼人杀游戏。                                             |
| #退出狼人杀              | 退出等待中的游戏（房主退出将解散游戏）。                                     |
| #开始狼人杀              | 房主开始游戏（需至少6人）。                                                 |
| #结束发言 / #发言结束     | 当前发言玩家在白天阶段结束自己的发言回合。                                   |
| #投票 [编号]              | 在白天投票阶段，投票淘汰指定编号的玩家（如 `#投票 01`）。                    |
| #狼人杀状态              | 查看当前游戏状态、存活玩家列表等信息。                                       |
| #结束狼人杀 / #强制结束狼人杀 | 房主、群管理员或机器人主人强制结束当前游戏。                               |

**私聊机器人指令**（需通过私聊发送）：
- `杀 [编号]` / `#杀 [编号]`：狼人在夜晚指定击杀目标编号。
- `查验 [编号]` / `#查验 [编号]`：预言家在夜晚指定查验目标编号。
- `救 [编号]` / `#救 [编号]`：女巫在夜晚第二阶段使用解药救指定编号的玩家。
- `毒 [编号]` / `#毒 [编号]`：女巫在夜晚第二阶段使用毒药毒杀指定编号的玩家。
- `守 [编号]` / `#守 [编号]`：守卫在夜晚指定守护目标编号。
- `开枪 [编号]` / `#开枪 [编号]`：猎人在死亡后选择开枪带走指定编号的玩家。

### 自定义速算（测试）

这是一个可自定义难度的速算小游戏，分为普通模式和无尽模式。

#### 可用指令

| 指令格式 | 功能描述 |
| :--- | :--- |
| **#速算**`[难度]` | 开始一次速算。<br>难度可选择：**简单、普通、困难、地狱**。<br>若不指定，则默认为【简单】。 |
| **#无尽速算**`[难度]` | 开始无尽模式挑战。<br>在该模式下，答对一题将自动进入下一题，直到答错、超时或放弃为止，最后会结算总得分。 |
| **#放弃** | 在答题过程中，可以发送此指令来结束当前游戏并查看正确答案。 |

