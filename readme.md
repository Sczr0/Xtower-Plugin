# Xtower-Plugin

Xtower-Plugin 是一个原有的 JS 功能集成 Plugin，包括了随机歌词与聪明 Bingo 功能，后续可能会继续添加。

## 安装

在 Yunzai 目录下运行：

> 使用Github

```
#安装插件本体
git clone --depth=1 https://github.com/Sczr0/Xtower-Plugin.git ./plugins/Xtower-Plugin/ 
#进入插件目录
cd ./plugins/Xtower-Plugin/ 
#安装插件所需依赖
pnpm install -P
```
> 使用Gitee

```
#安装插件本体
git clone --depth=1 https://gitee.com/sczr/Xtower-Plugin.git ./plugins/Xtower-Plugin/ 
#进入插件目录
cd ./plugins/Xtower-Plugin/ 
#安装插件所需依赖
pnpm install -P
```
> [!TIP]
> 如果安装依赖时速度过慢，运行：
> 
>```
> pnpm config set registry https://registry.npmmirror.com
>```

## 功能

### 随机歌词

在使用这个功能之前，你需要至少有一个 git 歌词存储库，并更新公用库，否则该功能不会正常工作。

歌词需要以 txt 格式存储，并建议去除歌手信息（除非你想抽歌词的时候抽出来这东西）（划掉）

如果一个歌词 txt 没有空行，使用抽歌词并选中该 txt 时，会随机发送一行

如果有，则会按照空行进行分段，并随机发送一段

具体分段的歌词可以参考：[yllyrics](https://github.com/Sczr0/yllyrics)

#### **以下为用户功能**

| **功能名称**               | **功能说明**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| 抽歌词 [-riv]              | 随机抽取一条歌词（添加 `-riv` 去除输出中的歌手信息）                        |
| 抽歌词 <数量> [-riv]       | 批量抽取指定数量的歌词（添加 `-riv` 去除输出中的歌手信息）                  |

#### **以下为管理功能**

| **功能名称**               | **功能说明**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| 获取歌词 <库名> <仓库名>   | 从指定的Git仓库获取歌词，并将其添加到指定的歌词库中                                  |
| 新建歌词仓库 <名称> <Git URL>  | 添加新的歌词Git仓库                                                            |
| 删除歌词仓库 <名称>        | 删除指定歌词Git仓库                                                            |
| 新建歌词库 <名称>          | 创建新的歌词库                                                              |
| 删除歌词库 <名称>          | 删除指定歌词库                                                              |
| 关联群组 <群号> <歌词库名> | 将群组与歌词库关联，该群组将只会抽取到该歌词库的歌词（删除歌词库时自动解除所有关联）                                                                                                 |
| 歌词库列表                 | 列出所有歌词库                                                              |
| 仓库列表                   | 列出所有歌词Git仓库                                                            |
| 设置频率限制 <次数> <冷却秒数> | 设置抽歌词频率限制                                                      |
| 更新公用库 <仓库名>        | 更新公用歌词库，该库为你默认想让用户抽取的歌词库 

### 聪明 Bingo

这是一个 bingo 游戏实现，原游戏为聪明 Bingo，游戏需要找到一个可以做到五连勾且同时满足所有格子要求的解。

#### 可用指令

| **指令格式**           | **功能描述**                                                                 |
|------------------------|-----------------------------------------------------------------------------|
| #今日bingo             | 获取今日题目                                                                |
| #bingo xx xx xx ...    | 提交题目答案，其中 `xx` 的第1个数代表行，第2个数代表列，比如 `13` 代表第一行第三列 |
| #查询Bingo排名         | 查询当前排名       |

### 谁是卧底

这是一个经典的"谁是卧底"游戏实现，玩家分为平民和卧底两种身份，通过发言和投票找出卧底或隐藏身份的游戏。

#### 游戏规则

- 游戏需要至少3人才能开始。
- 平民会获得相同的词语，卧底会获得一个相似的词语。
- 玩家轮流发言描述自己的词语（不能直接说出词语）。
- 发言结束后投票选出最可疑的玩家。
- 被投票淘汰的玩家会公开身份。
- **游戏目标**：
  - 平民：找出并淘汰卧底。
  - 卧底：隐藏身份活到最后。

#### 可用指令

| **指令格式**         | **功能描述**                                                                 |
|----------------------|-----------------------------------------------------------------------------|
| #卧底创建 [明牌/暗牌] | 创建游戏房间，可选明牌(公开身份)或暗牌(隐藏身份)模式，默认为暗牌。             |
| #加入卧底            | 加入已创建的游戏。                                                          |
| #退出卧底            | 退出等待中的游戏（房主退出将解散游戏）。                                     |
| #开始卧底            | 房主可开始游戏（需至少3人）。                                               |
| #结束发言 / #发言结束 | 当前发言玩家结束自己的发言回合。                                             |
| #投票 [编号]          | 投票淘汰指定编号的玩家（如 `#投票 01`）。                                    |
| #结束卧底            | 房主可强制结束进行中的游戏。                                                |